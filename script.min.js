const imageViewport=document.querySelector('.viewport.images');const infoViewport=document.querySelector('.viewport.info');const imageContainer=document.querySelector('.carrusel-container.images');const infoContainer=document.querySelector('.carrusel-container.info');let originalImageItems=Array.from(document.querySelectorAll('.carrusel-container.images .item'));let originalInfoItems=Array.from(document.querySelectorAll('.carrusel-container.info .item'));let allImageItems=[];let allInfoItems=[];let current=0;let isTransitioning=!1;let autoplay;const TRANSITION_MS=600;const CLONES_COUNT=2;function setupInfiniteCarousel(){if(!imageContainer)return;imageContainer.innerHTML='';infoContainer.innerHTML='';const endImageClones=originalImageItems.slice(-CLONES_COUNT).map(el=>el.cloneNode(!0));const endInfoClones=originalInfoItems.slice(-CLONES_COUNT).map(el=>el.cloneNode(!0));const startImageClones=originalImageItems.slice(0,CLONES_COUNT).map(el=>el.cloneNode(!0));const startInfoClones=originalInfoItems.slice(0,CLONES_COUNT).map(el=>el.cloneNode(!0));endImageClones.forEach(el=>{el.classList.add('clone');imageContainer.appendChild(el)});originalImageItems.forEach(el=>imageContainer.appendChild(el));startImageClones.forEach(el=>{el.classList.add('clone');imageContainer.appendChild(el)});endInfoClones.forEach(el=>{el.classList.add('clone');infoContainer.appendChild(el)});originalInfoItems.forEach(el=>infoContainer.appendChild(el));startInfoClones.forEach(el=>{el.classList.add('clone');infoContainer.appendChild(el)});allImageItems=Array.from(imageContainer.querySelectorAll('.item'));allInfoItems=Array.from(infoContainer.querySelectorAll('.item'));current=CLONES_COUNT;updateCarousel(!1);setTimeout(()=>{imageContainer.classList.add('ready');infoContainer.classList.add('ready')},50)}
function updateCarousel(animate=!0){if(!imageContainer)return;const allImages=imageContainer.querySelectorAll('img');if(animate){const transitionStyle=`transform ${TRANSITION_MS}ms cubic-bezier(0.25, 1, 0.5, 1)`;imageContainer.style.transition=transitionStyle;infoContainer.style.transition=transitionStyle;allImages.forEach(img=>img.style.transition='')}else{imageContainer.style.transition='none';infoContainer.style.transition='none';allImages.forEach(img=>img.style.transition='none')}
allImageItems.forEach((el,i)=>el.classList.toggle('active',i===current));allInfoItems.forEach((el,i)=>el.classList.toggle('active',i===current));centerItem(imageViewport,imageContainer,allImageItems,current);centerItem(infoViewport,infoContainer,allInfoItems,current);if(!animate){void imageContainer.offsetWidth;void infoContainer.offsetWidth}}
function centerItem(viewport,container,items,index){const active=items[index];if(!active)return;const isMobile=window.innerWidth<=480;if(isMobile){const viewportHeight=viewport.clientHeight;const activeHeight=active.clientHeight;const itemTop=active.offsetTop;const target=itemTop-(viewportHeight/2-activeHeight/2);container.style.transform=`translateY(${-target}px)`}else{const viewportWidth=viewport.clientWidth;const activeWidth=active.clientWidth;const itemLeft=active.offsetLeft;const target=itemLeft-(viewportWidth/2-activeWidth/2);container.style.transform=`translateX(${-target}px)`}}
function next(){if(isTransitioning)return;isTransitioning=!0;current++;updateCarousel(!0);setTimeout(()=>{checkInfinity();isTransitioning=!1},TRANSITION_MS+50)}
function prev(){if(isTransitioning)return;isTransitioning=!0;current--;updateCarousel(!0);setTimeout(()=>{checkInfinity();isTransitioning=!1},TRANSITION_MS+50)}
function checkInfinity(){const totalReal=originalImageItems.length;let hasTeleported=!1;if(current>=totalReal+CLONES_COUNT){current=CLONES_COUNT;hasTeleported=!0}
if(current<CLONES_COUNT){current=totalReal+CLONES_COUNT-1;hasTeleported=!0}
if(hasTeleported)updateCarousel(!1);}
function setupNavButtons(){const prevBtn=document.querySelector('.prev');const nextBtn=document.querySelector('.next');if(!prevBtn||!nextBtn)return;const newPrev=prevBtn.cloneNode(!0);const newNext=nextBtn.cloneNode(!0);prevBtn.parentNode.replaceChild(newPrev,prevBtn);nextBtn.parentNode.replaceChild(newNext,nextBtn);newPrev.addEventListener('click',(e)=>{e.preventDefault();stopAutoplay();prev()});newNext.addEventListener('click',(e)=>{e.preventDefault();stopAutoplay();next()})}
function setupAutoplay(){startAutoplay();const zone=document.querySelector('.carrusel');if(zone){['mouseenter','touchstart'].forEach(e=>zone.addEventListener(e,stopAutoplay));['mouseleave','touchend'].forEach(e=>zone.addEventListener(e,startAutoplay))}}
function startAutoplay(){if(autoplay)clearInterval(autoplay);autoplay=setInterval(next,3500)}
function stopAutoplay(){if(autoplay)clearInterval(autoplay);}
const splash=document.getElementById('splash');const slides=splash?Array.from(document.querySelectorAll('.splash-slide')):[];function runSplashSequenceOnce(){if(!splash){initAfterSplash();return}
const sessionShown=sessionStorage.getItem('splashShown')==='1';if(sessionShown){if(splash.parentNode)splash.parentNode.removeChild(splash);initAfterSplash();return}
const loadPromises=slides.map(img=>{if(img.complete)return Promise.resolve();return new Promise(r=>{img.onload=r;img.onerror=r})});Promise.all(loadPromises).then(()=>{let idx=0;const showNext=()=>{slides.forEach((s,i)=>s.classList.toggle('visible',i===idx));idx++;if(idx<slides.length)setTimeout(showNext,2000);else setTimeout(()=>{splash.classList.add('splash-hide');sessionStorage.setItem('splashShown','1');setTimeout(()=>{if(splash.parentNode)splash.parentNode.removeChild(splash);initAfterSplash()},800)},2000)};showNext()})}
function initAfterSplash(){document.documentElement.style.overflow='';document.body.style.overflow='';if(window.innerWidth<=480){createMobileLayout();stopAutoplay()}else{requestAnimationFrame(()=>{setupInfiniteCarousel();setupNavButtons();setupAutoplay()})}
window.addEventListener('resize',()=>{if(window.innerWidth>480&&document.getElementById('mobile-carousel-view')){location.reload()}})}
document.addEventListener('DOMContentLoaded',()=>{runSplashSequenceOnce()});function createMobileLayout(){if(window.innerWidth>480)return;if(document.getElementById('mobile-carousel-view'))return;const rawImages=document.querySelectorAll('.viewport.images .carrusel-container.images .item:not(.clone) img');const rawInfos=document.querySelectorAll('.viewport.info .carrusel-container.info .item:not(.clone)');const mobileContainer=document.createElement('div');mobileContainer.id='mobile-carousel-view';rawImages.forEach((img,index)=>{const infoItem=rawInfos[index];if(!infoItem)return;const num=infoItem.querySelector('.number').innerText;const name=infoItem.querySelector('.name').innerText;const link=infoItem.querySelector('.plus').getAttribute('href');const card=document.createElement('div');card.className='mobile-card';card.innerHTML=`
      <a href="${link}">
        <img src="${img.getAttribute('src')}" alt="${name}">
      </a>
      <div class="mobile-info-row">
        <span class="m-num">${num}</span>
        <span class="m-name">${name}</span>
        <a href="${link}" class="m-plus">+</a>
      </div>
    `;mobileContainer.appendChild(card)});const main=document.querySelector('main');main.appendChild(mobileContainer)}